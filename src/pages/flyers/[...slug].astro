---
import {getCollection} from 'astro:content';
import Block from "../../Block.astro";

export async function getStaticPaths() {
  const flyerEntries = await getCollection('flyers');
  return flyerEntries.map(entry => ({
    params: {slug: entry.slug}, props: {entry},
  }));
}

const {entry} = Astro.props;
const {Content} = await entry.render();
console.log("entry", entry.data.blocks)

const blocksEntries = await getCollection('blocks', (blockEntry) => {
  console.log("blockEntry", blockEntry)

  return entry.data.blocks.some((block) => {
    return block.slug === blockEntry.slug;
  });
});



    console.log("blocksEntries", blocksEntries);
---

<html lang="en">
<head>
    <meta charset="utf-8"/>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg"/>
    <meta name="viewport" content="width=device-width"/>
    <meta name="generator" content={Astro.generator}/>
    <title>{entry.data.title}</title>
</head>
<body>
<h1>Flyer {entry.data.title}</h1>
<a href="/">home</a>

<Content></Content>

{blocksEntries.map((block)=>(
<Block block={block}></Block>
))}

</body>
</html>
